+++
title = 'AoC 2024 Dzień - 6'
date = 2024-12-06T10:15:30+01:00
draft = true
+++

# Zadanie
W dzisiejszym zadaniu należy prześledzić ścieżkę strażnika w 2 wymiarowej przestrzeni,
wyglądającej tak:
```
..#..
.#..#
.....
#.^..
```
Początkowa pozycja strażnika oznaczona jest jako `^`, z kolei `#` oznaczają przeszkody,
ścieżka strażnika wygląda tak, że idzie on cały czas do przodu, aż stanie bezpośrednio
przed przeszkodą, wtedy skręca w prawo o 90 stopni.

Naszym zadaniem jest prześledzić jego ścieżę aż do momentu kiedy wyjdzie on poza znaną
nam przestrzeń, wtedy należy policzyć ilość unikalnych pól na których stanął on przec całą
swoją podróż. Dla powyższego przykładu ścieżka wygląda tak:
```
..#..
.#oo#
..||.
#.^|.
```
A wynik wynosi 6.

## Rozwiązanie
### Parsowanie
Zaczniemy od parsowania wejścia, na pewno potrzebne będą nam pozycja początkowa strażnika
jak i pozycje wszystkich przeszków. Dobrze też otrzymać wielkośc planszy żebyśmy mogli
stwierdzić w którym momencie strażnik ją opuścił.

Poniższy kod wyciąga wszystkie te wartości:
```awk
# part1.awk
BEGIN {FS = ""}
{
    for (i = 1; i <= NF; i++) {
        if ($i == "#") {
            obstacles[NR][i] = 1
        }
        if ($i == "^") {
            guardx = i
            guardy = NR
        }
    }
} END {
    printf "Guard pos: (%d, %d)\n", guardx, guardy
    print "Obstacles: "
    for (row in obstacles) {
        for (col in obstacles[row]) {
            print row, col 
        }
    }
    print "Max row: ", NR
    print "Max col: ", NF
```

### Śledzenie ścieżki
zmienne `dx`, `dy` są wystarczające by trzymać aktualny kierunek w który zwrócony jest
strażnik:
```awk
    dx = 0; dy = -1  # zwrócony w górę
    while(guardx >= 1 && guardy >= 1 && guardx <= NF && guardy <= NR) {
        visited[guardy][guardx] = 1
        newx = guardx + dx
        newy = guardy + dy
        if (obstacles[newy][newx]) { # napotkano przeszkodę
            # zmiana kierunku (aktualizacja dx, dy)
            ...
        } else {
            # zmiana pozycji (aktualizacja guardx, guardy)
            guardx = newx
            guardy = newy
        }
    }
```

#### Aktualizacja kierunku
Kiedy napotkamy przeszkodę zmieniamy kierunek żeby iśc w prawo poniższy kod to osiąga:
```awk
...
        # zmiana kierunku (aktualizacja dx, dy)
        if (dx == 0) {
            if (dy == -1) dx = 1
            else dx = -1   
            dy = 0
        } else {
            if (dx == 1) dy = 1
            else dy = -1
            dx = 0
        }
...
```
### Liczenie odwiedzonych pól
Na końcu bez problemu możemy zliczyć ilość odwiedzonych pól
```awk
...
    # count number of visited tiles
    for (row in visited) {
        for (col in visited[row]) {
            res += visited[row][col]
        }
    }
    print res

```
Uruchamiamy kod przez:
```bash
awk -f part1.awk input.txt
```
I widzimy poprawny wynik!

